<!DOCTYPE html>
<html lang="en" itemscope itemtype="http://schema.org/WebPage">
  <head>
    
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">


<title>Mounting LVM backed XEN disk partitions in DOM0 - Kev&#39;s Site</title>
<meta name="description" content="Sometimes you might need to mount a DOMU’s disk in DOM0, so that you can edit files, or even recover them in the event that your DOMU is broken and fails to boot.">
<script type="application/ld+json">
{
    "@context": "http://schema.org",
    "@type": "WebSite",
    "name": "Kev\u0027s Site",
    
    "url": "https:\/\/www.kevssite.com\/"
}
</script><script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "Organization",
  "name": "",
  "url": "https:\/\/www.kevssite.com\/"
  
  
  
  
}
</script>
<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [{
        "@type": "ListItem",
        "position": 1,
        "item": {
          "@id": "https:\/\/www.kevssite.com\/",
          "name": "home"
        }
    },{
        "@type": "ListItem",
        "position": 3,
        "item": {
          "@id": "https:\/\/www.kevssite.com\/mounting-lvm-backed-xen-disk-partitions-in-dom0\/",
          "name": "Mounting lvm backed xen disk partitions in dom0"
        }
    }]
}
</script><script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "Article",
  "author": {
    "name" : "map[github:YorkshireKev linkedin:elliskevin twitter:YorkshireKev website:https:\/\/www.kevssite.com\/ youtube:@kevschannel]"
  },
  "headline": "Mounting LVM backed XEN disk partitions in DOM0",
  "description" : "Sometimes you might need to mount a DOMU’s disk in DOM0, so that you can edit files, or even recover them in the event that your DOMU is broken and fails to boot.\n",
  "inLanguage" : "en",
  "wordCount":  301 ,
  "datePublished" : "2010-10-27T00:00:00",
  "dateModified" : "2010-10-27T00:00:00",
  "image" : "https:\/\/www.kevssite.com\/",
  "keywords" : [ "dom0, domu, LVM, Xen virtualization" ],
  "mainEntityOfPage" : "https:\/\/www.kevssite.com\/mounting-lvm-backed-xen-disk-partitions-in-dom0\/",
  "publisher" : {
    "@type": "Organization",
    "name" : "https:\/\/www.kevssite.com\/",
    "logo" : {
        "@type" : "ImageObject",
        "url" : "https:\/\/www.kevssite.com\/",
        "height" :  60 ,
        "width" :  60
    }
  }
}
</script>

<meta property="og:title" content="Mounting LVM backed XEN disk partitions in DOM0" />
<meta property="og:description" content="Sometimes you might need to mount a DOMU’s disk in DOM0, so that you can edit files, or even recover them in the event that your DOMU is broken and fails to boot.">
<meta property="og:url" content="https://www.kevssite.com/mounting-lvm-backed-xen-disk-partitions-in-dom0/" />
<meta property="og:type" content="website" />
<meta property="og:site_name" content="Kev&#39;s Site" />
<link rel="apple-touch-icon" sizes="180x180" href=" https://www.kevssite.com/favicon/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://www.kevssite.com/favicon/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="https://www.kevssite.com/favicon/favicon-16x16.png">


<meta name="generator" content="Hugo 0.150.1">
<link rel="alternate" href="https://www.kevssite.com/index.xml" type="application/rss+xml" title="Kev&#39;s Site">
<script src="https://www.kevssite.com/js/dark-mode.js"></script><script src="https://cdn.jsdelivr.net/npm/lunr@2.3.9/lunr.min.js" integrity="sha384-203J0SNzyqHby3iU6hzvzltrWi/M41wOP5Gu+BiJMz5nwKykbkUx8Kp7iti0Lpli" crossorigin="anonymous"></script><script src="https://www.kevssite.com/js/lunr-search.js" data-index="/search.json"></script><link rel="stylesheet" href="/style.min.css">







 

 <link href="https://www.kevssite.com/vendor/glightbox/css/glightbox.min.css" rel="stylesheet">


<script src="https://www.kevssite.com/vendor/glightbox/js/glightbox.min.js"></script>
 
  </head>
  <body>
    
<div class="container fixed-top mw-100">
  <div class="row justify-content-center">
    <div class="col-sm-12 col-md-12 col-lg-10 col-xl-10">

      <nav class="navbar navbar-expand-lg navbar-light fixed-top p-0">
        <div class="container">

          <a class="navbar-brand fw-bold" href="https://www.kevssite.com/">Kev&#39;s Site</a>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav"
            aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
          </button>

          <div class="collapse navbar-collapse justify-content-end" id="navbarNav">
            <ul class="navbar-nav mb-2 mb-lg-0 align-items-baseline">
              
              

              <li class="nav-item">

                
                
                
                
                

                <a class="nav-link " title="Home"
                  href="/"> Home</a>
              </li>

              
              
              

              <li class="nav-item">

                
                
                
                
                

                <a class="nav-link " title="Games"
                  href="/categories/games/"> Games</a>
              </li>

              
              
              

              <li class="nav-item">

                
                
                
                
                

                <a class="nav-link " title="Categories"
                  href="/categories/"> Categories</a>
              </li>

              
              
              

              <li class="nav-item">

                
                
                
                
                

                <a class="nav-link " title="Tags"
                  href="/tags/"> Tags</a>
              </li>

              
              
              

              <li class="nav-item">

                
                
                
                
                

                <a class="nav-link " title="About"
                  href="/about/"> About</a>
              </li>

              
              

              <li class="nav-item nav-link">
                <a id="dark-mode-toggle" class="bi bi-moon-stars" role="button"></a>
              </li>

              
              <li class="nav-item search-item">
                <form id="search" class="search" role="search">
                  <label for="search-input" class="bi bi-search search-icon"></label>
                  <input type="search" id="search-input" class="search-input">
                </form>
              </li>
              
            </ul>

            
            <template id="search-heading" hidden
                data-results-none="No results found for “{}”"
                data-results-one="Found one result for “{}”"
                data-results-many="Found 13579 results for “{}”"
            >
              <div class="row">
                <div class="col-lg-8 offset-lg-2 col-md-10 offset-md-1 ">
                  <h1 id="search-title" class="search-title"></h1>
                </div>
              </div>
            </template>

            <template id="search-result" hidden>
              <div class="row">
                <div class="col-lg-8 offset-lg-2 col-md-10 offset-md-1 ">
                  <article class="content post">
                    <h2><a class="summary-title-link"></a></h2>
                    <div class="post-entry"></div>
                    <div class="read-more-section">
                      <h6 class="text-muted link-underline">
                        <a class="read-more-link">
                          Read More
                          <i class="bi bi-arrow-right"></i>
                        </a>
                      </h6>
                    </div>
                  </article>
                </div>
              </div>
            </template>
            
          </div>
        </div>
      </nav>

    </div>
  </div>
</div>

    









<header class="header-section ">

  <div class="intro-header no-img mt-10 pb-2">
    <div class="container">
      <div class="row justify-content-center">

        
          
          <div class="col-sm-12  col-md-12 col-lg-8 col-xl-8 non-tags-sec">
            
            
          </div>
          <div class="col-sm-12  col-md-12 col-lg-8 col-xl-8 non-tags-sec">
            


            
            

            
            <div class="post-heading">
              <h1 class="fw-medium lh-1 align-items-center">
                Mounting LVM backed XEN disk partitions in DOM0
                
              </h1>
            </div>


            

            

            

            
            
            <span class="post-meta">
  <div class="row post-meta text-muted">
    <div class="col-sm-12 col-md-6 px-0">
      
      
  
      
      
      
  
      &nbsp; October 27, 2010
    </div>

  <div class="col-sm-12 col-md-6 text-sm-start text-md-end px-0">
  

  
</div>

  
</div>
</span>


            
            
          </div>
        </div>
      </div>
    </div>
  </div>
</header>


    
<div class="container" role="main">
  <div class="row">
    
    </div>

    <div class="col-lg-8 offset-lg-2 col-md-10 offset-md-1 pt-4">
      <article role="main" class="blog-post">
        <p>Sometimes you might need to mount a DOMU’s disk in DOM0, so that you can edit files, or even recover them in the event that your DOMU is broken and fails to boot.</p>
<p>kpartx is a handy command line tool that creates device maps from partition tables. So it can be used to create device mappings (in /dev/mapper/) for file and LVM backed DOM0 disks. In this short guide, I’ll be using LVM backed disks for examples…</p>
<p>The following assumes that the logical volume is called naslv and is in volume group datavg. Amend these to fit your system.</p>
<p>list partitions in an LVM logic volume:<br>
<code>kpartx -l /dev/mapper/datavg-naslv</code></p>
<p>Example output:<br>
<code>datavg-naslv1 : 0 208782 /dev/mapper/datavg-naslv 63&lt;br /&gt; datavg-naslv2 : 0 2088450 /dev/mapper/datavg-naslv 208845&lt;br /&gt; datavg-naslv3 : 0 6088635 /dev/mapper/datavg-naslv 2297295</code></p>
<p>As you can see, each partition is number is added to the end of the device name. A this stage we’ve just listed them, the device mapper has not been amended yet.</p>
<p>Now we add the partitions to the device mapper list, so that they can be mounted:<br>
<code>kpartx -a /dev/mapper/datavg-naslv</code></p>
<p>Check that they have been added to device mapper:<br>
<code>ls -l /dev/mapper/datavg-naslv*</code></p>
<p>example output:<br>
<code>brw-rw---- 1 root disk 253, 9 2010-07-10 10:06 /dev/mapper/datavg-naslv&lt;br /&gt; brw-rw---- 1 root disk 253, 11 2010-07-10 21:10 /dev/mapper/datavg-naslv1&lt;br /&gt; brw-rw---- 1 root disk 253, 12 2010-07-10 21:10 /dev/mapper/datavg-naslv2&lt;br /&gt; brw-rw---- 1 root disk 253, 13 2010-07-10 21:10 /dev/mapper/datavg-naslv3</code></p>
<p>Now mount the required partition (filesytem) so that you can read/edit the files it contains:<br>
<code>mount /dev/mapper/datavg-naslv3 /mnt/xvda3</code></p>
<p>When done, unmount the partition (filesystem):<br>
<code>umount /mnt/xvda3</code></p>
<p>Now to tidy up and remove the partitions we added to the device mapper list:<br>
<code>kpartx -d /dev/mapper/datavg-naslv</code></p>
<p>Confirm everything is back to pre faffing state:<br>
<code>ls -l /dev/mapper/datavg-naslv*</code></p>
<p>example output:<br>
<code>brw-rw---- 1 root disk 253, 9 2010-07-10 10:06 /dev/mapper/datavg-naslv</code></p>
      </article>
    </div>
  </div>

  
  <div class="row">
    <div class="col-lg-8 offset-lg-2 col-md-10 offset-md-1">
      <hr class="m-0"/>
    </div>
    <div class="col-lg-8 offset-lg-2 col-md-10 offset-md-1 pt-2">
      
      <div class="blog-tags">
        
        <a href="https://www.kevssite.com/tags/dom0/">dom0</a>
        
        <a href="https://www.kevssite.com/tags/domu/">domu</a>
        
        <a href="https://www.kevssite.com/tags/lvm/">LVM</a>
        
        <a href="https://www.kevssite.com/tags/xen-virtualization/">Xen virtualization</a>
        
      </div>
      
    </div>

    <div class="col-lg-8 offset-lg-2 col-md-10 offset-md-1 pt-4">
      
    </div>

    
    <div class="col-lg-8 offset-lg-2 col-md-10 offset-md-1 mt-3">
      <div class="card">
        <div class="row no-gutters">
          <div class="col-md-10">
            <div class="card-body p-1.1">
              <p class="p-0 m-0"><small class="text-muted">Written By</small></p>
              <p class="card-text fs-5 m-0">

                
                Kev
                

              </p>
              
            </div>
          </div>
        </div>
      </div>
    </div>
    

    <div class="col-lg-8 offset-lg-2 col-md-12 offset-md-1 pt-4">
      
      <ul class="list-group list-group-horizontal" style="flex-direction: row">
        
        <li class="list-group-item b-0 p-0">

          <a type="button" class="btn btn-dark" role="button" href="https://www.kevssite.com/matthew-smith-interview/"
            data-toggle="tooltip" data-placement="top" title="Matthew Smith Interview">&larr;
            Previous Post</a>
        </li>
        


        
        <li class="list-group-item ms-auto b-0 p-0">
          <a type="button" class="btn btn-dark" role="button" href="https://www.kevssite.com/mini-itx-mythtv-frontend/"
            data-toggle="tooltip" data-placement="top" title="Mini ITX MythTV Frontend">Next Post
            &rarr;</a>
        </li>
        
      </ul>
      
    </div>

    <div class="col-lg-8 offset-lg-2 col-md-10 offset-md-1 pt-4">
    </div>
  </div>
  
</div>

<div class="">
  
  
  
  
  

  
  <div class="container">
    <div class="row">
      <div class="col-lg-12 col-md-12 mt-3">
        <h3>Related Posts</h3>
        <hr />
      </div>

      
      

      
<div class="col-xl-4 col-lg-4 col-md-6 col-sm-6 mb-4">
    <a href="https://www.kevssite.com/installing-a-xen-hvm-domu/">
        <div class="card single-post-card h-100 shadow-effect border rounded-4">
            <div class="card-body">
                <h3 class="fw-medium post-title">Installing a XEN hvm DOMU</h3>
                
                <p class="post-meta">
                    <span class="post-meta text-muted">
  
  

  June 14, 2009

  

  

  

  
</span>

                </p>
            </div>

            

            

            <div class="card-body">
                
                <div class="post-entry text-secondary">
                    
                    For this to work your CPU and motherboard needs to support vt (intel) or amd-v. You can check this by looking at the flags in /proc/cpuinfo. Your looking for either vmx or svm on the flags line.
If you’re doing this from your DOM0 then these flags may not actually show up. Instead type xm info and look for ‘hvm’ on the virt_caps line.
For my hvm install, i’ll be installing Ubuntu 9.04 Desktop Linux.
I have copied the live CD ISO onto my XEN DOM0 and will be installing directly from the iso rather than burning the CD. I have also created a 10GB LVM logical volume to act as the disk for my new DOMU.

                    
                </div>

                <div class="read-more-section">
                    <h6 class="text-muted ">Read More <i class="bi bi-arrow-right"></i></h6>
                </div>
            </div>
        </div>
    </a>
</div>


      

      
<div class="col-xl-4 col-lg-4 col-md-6 col-sm-6 mb-4">
    <a href="https://www.kevssite.com/manually-creating-a-xen-domu-instance/">
        <div class="card single-post-card h-100 shadow-effect border rounded-4">
            <div class="card-body">
                <h3 class="fw-medium post-title">Manually creating a Xen DOMU instance</h3>
                
                <p class="post-meta">
                    <span class="post-meta text-muted">
  
  

  April 13, 2009

  

  

  

  
</span>

                </p>
            </div>

            

            

            <div class="card-body">
                
                <div class="post-entry text-secondary">
                    
                    If you’ve followed my guide to installing xen from source then you might now be wondering how to create your first VM.
This guide will show you how to manually create and install a VM (known as a DOMU instance in Xen) without any additional tools such as virt-manager, virt-install or virsh. These tools can help the novice, but are quite limiting when it comes to the advance features of xen.
For this example I’ll be installing CentOS5, but this should work for any red-hat based distro (please note there is a bug in fedora10 that stops it booting under xen). This example also uses the paravirtual kernel so it will work even if your CPU does not support AMD-V or intel-VT.
Right, down to business. The first thing we need to do is create a file to user as the hard disk for the DOMU. There are other options for providing hard disks to a DOMU, and I’ll cover some of them in a later guide but for this install I’ll be using a file.
The command below will create an 8GB file that will be used as an 8GB drive. The whole file will be written to disk in one go so may take a short while to complete.
dd if=/dev/zero of=/xenimages/test01/disk1.img oflag=direct bs=1M count=8192

                    
                </div>

                <div class="read-more-section">
                    <h6 class="text-muted ">Read More <i class="bi bi-arrow-right"></i></h6>
                </div>
            </div>
        </div>
    </a>
</div>


      

      
<div class="col-xl-4 col-lg-4 col-md-6 col-sm-6 mb-4">
    <a href="https://www.kevssite.com/lvm-how-to/">
        <div class="card single-post-card h-100 shadow-effect border rounded-4">
            <div class="card-body">
                <h3 class="fw-medium post-title">LVM how to</h3>
                
                <p class="post-meta">
                    <span class="post-meta text-muted">
  
  

  April 7, 2009

  

  

  

  
</span>

                </p>
            </div>

            

            

            <div class="card-body">
                
                <div class="post-entry text-secondary">
                    
                    This is a quick and dirty guide to setting up an LVM based filesystem.
First create some disk partitions. In this example I’ve got two identical unformatted partitions on a couple of hard drives. These appear in /dev as sda4 and sdb4. Please note your partition number will most likely be different.
Also note that it’s easy to break your system with some of these commands. You have been warned, so don’t blame me if you wipe your system out!
First make the partitions available to LVM:
pvcreate /dev/sda4
Physical volume “/dev/sda4″ successfully created

                    
                </div>

                <div class="read-more-section">
                    <h6 class="text-muted ">Read More <i class="bi bi-arrow-right"></i></h6>
                </div>
            </div>
        </div>
    </a>
</div>


      
    </div>
  </div>
  
  

  

</div>

    


<footer>

  <div class="container">
    <div class="row">
      <div class="col-md-12">
        <ul
          class="list-inline list-group list-group-horizontal text-center footer-links d-flex justify-content-center flex-row">

          
          <li>
            <a href="https://github.com/YorkshireKev" title="GitHub" target="_blank">
              <span class="mx-2">
                <i class="bi bi-github"></i>
              </span>
            </a>
          </li>
          <li>
            <a href="https://twitter.com/YorkshireKev" title="Twitter" target="_blank">
              <span class="mx-2">
                <i class="bi bi-twitter-x"></i>
              </span>
            </a>
          </li>
          <li>
            <a href="https://linkedin.com/in/elliskevin" title="LinkedIn" target="_blank">
              <span class="mx-2">
                <i class="bi bi-linkedin"></i>
              </span>
            </a>
          </li>
          <li>
            <a href="https://www.youtube.com/@kevschannel" title="Youtube" target="_blank">
              <span class="mx-2">
                <i class="bi bi-youtube"></i>
              </span>
            </a>
          </li>
          
        </ul>
      </div>
    </div>

    <div class="row">
      <div class="col-md-12">
        <p class="credits copyright text-muted">
          
          &nbsp;&copy;
          
          2009 - 2025
          
          Kevin Ellis
        </p>
      </div>
    </div>
  </div>
</footer><script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" crossorigin="anonymous"></script>
<script src="https://www.kevssite.com/js/highlight.min.js"></script>
<script> hljs.initHighlightingOnLoad(); </script>
<script> $(document).ready(function () { $("pre.chroma").css("padding", "0"); }); </script>
    
  </body>
</html>

