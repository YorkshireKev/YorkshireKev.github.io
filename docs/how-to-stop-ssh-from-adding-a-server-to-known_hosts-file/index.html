<!DOCTYPE html>
<html lang="en" itemscope itemtype="http://schema.org/WebPage">
  <head>
    
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">


<title>How to stop ssh from adding a server to known_hosts file - Kev&#39;s Site</title>
<meta name="description" content="If you do a fair amount of tinkering on cloud servers, such as EC2 or Digital Ocean, then you&rsquo;ll have noticed that each time you start a server it gets a new IP address allocated. Then when you next log on to the server via ssh the server gets added to your known_hosts file.
Before long your known_host file has dozens, if not hundreds of entries for servers that you&rsquo;ve long shut down and discarded.
At first I would edit the known host file and remove the server entry once I&rsquo;d done with the server, but this got tiresome after a while.  So, I decided that for the servers I&rsquo;m just messing about on I&rsquo;d rather not add the server into the known_hosts file at all.">
<script type="application/ld+json">
{
    "@context": "http://schema.org",
    "@type": "WebSite",
    "name": "Kev\u0027s Site",
    
    "url": "http:\/\/www.kevssite.com\/"
}
</script><script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "Organization",
  "name": "",
  "url": "http:\/\/www.kevssite.com\/"
  
  
  
  
}
</script>
<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [{
        "@type": "ListItem",
        "position": 1,
        "item": {
          "@id": "http:\/\/www.kevssite.com\/",
          "name": "home"
        }
    },{
        "@type": "ListItem",
        "position": 3,
        "item": {
          "@id": "http:\/\/www.kevssite.com\/how-to-stop-ssh-from-adding-a-server-to-known_hosts-file\/",
          "name": "How to stop SSH from adding a server to known hosts file"
        }
    }]
}
</script><script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "Article",
  "author": {
    "name" : "Kev"
  },
  "headline": "How to stop ssh from adding a server to known_hosts file",
  "description" : "If you do a fair amount of tinkering on cloud servers, such as EC2 or Digital Ocean, then you\u0026rsquo;ll have noticed that each time you start a server it gets a new IP address allocated. Then when you next log on to the server via ssh the server gets added to your known_hosts file.\nBefore long your known_host file has dozens, if not hundreds of entries for servers that you\u0026rsquo;ve long shut down and discarded.\nAt first I would edit the known host file and remove the server entry once I\u0026rsquo;d done with the server, but this got tiresome after a while. So, I decided that for the servers I\u0026rsquo;m just messing about on I\u0026rsquo;d rather not add the server into the known_hosts file at all.\n",
  "inLanguage" : "en",
  "wordCount":  316 ,
  "datePublished" : "2014-01-03T00:00:00",
  "dateModified" : "2014-01-03T00:00:00",
  "image" : "http:\/\/www.kevssite.com\/",
  "keywords" : [ "" ],
  "mainEntityOfPage" : "http:\/\/www.kevssite.com\/how-to-stop-ssh-from-adding-a-server-to-known_hosts-file\/",
  "publisher" : {
    "@type": "Organization",
    "name" : "http:\/\/www.kevssite.com\/",
    "logo" : {
        "@type" : "ImageObject",
        "url" : "http:\/\/www.kevssite.com\/",
        "height" :  60 ,
        "width" :  60
    }
  }
}
</script>

<meta property="og:title" content="How to stop ssh from adding a server to known_hosts file" />
<meta property="og:description" content="If you do a fair amount of tinkering on cloud servers, such as EC2 or Digital Ocean, then you&rsquo;ll have noticed that each time you start a server it gets a new IP address allocated. Then when you next log on to the server via ssh the server gets added to your known_hosts file.
Before long your known_host file has dozens, if not hundreds of entries for servers that you&rsquo;ve long shut down and discarded.
At first I would edit the known host file and remove the server entry once I&rsquo;d done with the server, but this got tiresome after a while.  So, I decided that for the servers I&rsquo;m just messing about on I&rsquo;d rather not add the server into the known_hosts file at all.">
<meta property="og:url" content="http://www.kevssite.com/how-to-stop-ssh-from-adding-a-server-to-known_hosts-file/" />
<meta property="og:type" content="website" />
<meta property="og:site_name" content="Kev&#39;s Site" />
<link rel="apple-touch-icon" sizes="180x180" href=" http://www.kevssite.com/favicon/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="http://www.kevssite.com/favicon/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="http://www.kevssite.com/favicon/favicon-16x16.png">


<meta name="generator" content="Hugo 0.123.3">
<link rel="alternate" href="http://www.kevssite.com/index.xml" type="application/rss+xml" title="Kev&#39;s Site">
<script src="http://www.kevssite.com/js/dark-mode.js"></script><script src="https://cdn.jsdelivr.net/npm/lunr@2.3.9/lunr.min.js" integrity="sha384-203J0SNzyqHby3iU6hzvzltrWi/M41wOP5Gu+BiJMz5nwKykbkUx8Kp7iti0Lpli" crossorigin="anonymous"></script><script src="http://www.kevssite.com/js/lunr-search.js" data-index="/search.json"></script><link rel="stylesheet" href="/style.min.css">







  </head>
  <body>
    
<div class="container fixed-top mw-100">
  <div class="row justify-content-center">
    <div class="col-sm-12 col-md-12 col-lg-10 col-xl-10">

      <nav class="navbar navbar-expand-lg navbar-light fixed-top p-0">
        <div class="container">

          <a class="navbar-brand fw-bold" href="http://www.kevssite.com/">Kev&#39;s Site</a>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav"
            aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
          </button>

          <div class="collapse navbar-collapse justify-content-end" id="navbarNav">
            <ul class="navbar-nav mb-2 mb-lg-0 align-items-baseline">
              
              

              <li class="nav-item">

                
                
                
                
                

                <a class="nav-link " title="Home"
                  href="/"> Home</a>
              </li>

              
              
              

              <li class="nav-item">

                
                
                
                
                

                <a class="nav-link " title="Games"
                  href="/categories/games/"> Games</a>
              </li>

              
              
              

              <li class="nav-item">

                
                
                
                
                

                <a class="nav-link " title="Categories"
                  href="/categories/"> Categories</a>
              </li>

              
              
              

              <li class="nav-item">

                
                
                
                
                

                <a class="nav-link " title="Tags"
                  href="/tags/"> Tags</a>
              </li>

              
              
              

              <li class="nav-item">

                
                
                
                
                

                <a class="nav-link " title="About"
                  href="/about/"> About</a>
              </li>

              
              

              <li class="nav-item nav-link">
                <a id="dark-mode-toggle" class="bi bi-moon-stars" role="button"></a>
              </li>

              
              <li class="nav-item search-item">
                <form id="search" class="search" role="search">
                  <label for="search-input" class="bi bi-search search-icon"></label>
                  <input type="search" id="search-input" class="search-input">
                </form>
              </li>
              
            </ul>

            
            <template id="search-heading" hidden
                data-results-none="No results found for “{}”"
                data-results-one="Found one result for “{}”"
                data-results-many="Found 13579 results for “{}”"
            >
              <div class="row">
                <div class="col-lg-8 offset-lg-2 col-md-10 offset-md-1 ">
                  <h1 id="search-title" class="search-title"></h1>
                </div>
              </div>
            </template>

            <template id="search-result" hidden>
              <div class="row">
                <div class="col-lg-8 offset-lg-2 col-md-10 offset-md-1 ">
                  <article class="content post">
                    <h2><a class="summary-title-link"></a></h2>
                    <div class="post-entry"></div>
                    <div class="read-more-section">
                      <h6 class="text-muted link-underline">
                        <a class="read-more-link">
                          Read More
                          <i class="bi bi-arrow-right"></i>
                        </a>
                      </h6>
                    </div>
                  </article>
                </div>
              </div>
            </template>
            
          </div>
        </div>
      </nav>

    </div>
  </div>
</div>

    









<header class="header-section ">

  <div class="intro-header no-img mt-10">
    <div class="container">
      <div class="row justify-content-center">
        
        <div class="col-sm-12 col-md-12 col-lg-8 col-xl-8">
          

          
          <div class="col-sm-12 col-md-12 col-lg-12 col-xl-12">
            

            <div class="post-heading">
              

              

              
              <h1 class="fw-semibold display-5 lh-1 mb-3"> 
                How to stop ssh from adding a server to known_hosts file
                
              </h1>
              
              

              

              
              
              <span class="post-meta">
  
  
  &nbsp;January 3, 2014

  

  

  
</span>


              
              
            </div>
          </div>
          
        </div>
        
        
      </div>
      
    </div>
  </div>
</header>



    
<div class="container" role="main">
  <div class="row">
    
    </div>

    <div class="col-lg-8 offset-lg-2 col-md-10 offset-md-1 pt-4">
      <article role="main" class="blog-post">
        <p>If you do a fair amount of tinkering on cloud servers, such as EC2 or Digital Ocean, then you&rsquo;ll have noticed that each time you start a server it gets a new IP address allocated. Then when you next log on to the server via ssh the server gets added to your known_hosts file.</p>
<p>Before long your known_host file has dozens, if not hundreds of entries for servers that you&rsquo;ve long shut down and discarded.</p>
<p>At first I would edit the known host file and remove the server entry once I&rsquo;d done with the server, but this got tiresome after a while.  So, I decided that for the servers I&rsquo;m just messing about on I&rsquo;d rather not add the server into the known_hosts file at all.</p>
<p>Warning! Before proceeding you should be aware that the reason the remote server is added to the known host file is to prevent man-in-the-middle attacks. So preventing the entry being added will compromise your security. This is why I only do this for the temporary servers that know I&rsquo;ll be deleting shortly. I suggest you do the same!</p>
<p>To prevent the server being added to the known_hosts file we can simply tell ssh to use a different known_hosts file. I use the black hole /dev/null as in the example below.
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>ssh -q -o UserKnownHostsFile<span style="color:#f92672">=</span>/dev/null user@hostname/IP-address</span></span></code></pre></div></p>
<p>The next problem to overcome is that everytime you connect ssh will warn you that the server identity cannot be verified and you have to type &lsquo;yes&rsquo; to continue. This is because the server is not listed in your known_host file and so ssh acts at though every connection is the first connection. To fix this we can switch off host checking (again, another security compromise!). The example below shows the ssh command with both options set. The -q option just stops ssh from throwing out warning messages.
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>ssh -q -o UserKnownHostsFile<span style="color:#f92672">=</span>/dev/null -o StrictHostKeyChecking<span style="color:#f92672">=</span>no user@hostname/IP-address</span></span></code></pre></div></p>
      </article>
    </div>
  </div>

  
  <div class="row">
    <div class="col-lg-8 offset-lg-2 col-md-10 offset-md-1">
      <hr class="m-0"/>
    </div>
    <div class="col-lg-8 offset-lg-2 col-md-10 offset-md-1 pt-2">
      
    </div>

    <div class="col-lg-8 offset-lg-2 col-md-10 offset-md-1 pt-4">
      
    </div>

    
    <div class="col-lg-8 offset-lg-2 col-md-10 offset-md-1 mt-3">
      <div class="card">
        <div class="row no-gutters">
          <div class="col-md-10">
            <div class="card-body p-1.1">
              <p class="p-0 m-0"><small class="text-muted">Written By</small></p>
              <p class="card-text fs-5 m-0">

                
                Kev
                

              </p>
              
            </div>
          </div>
        </div>
      </div>
    </div>
    

    <div class="col-lg-8 offset-lg-2 col-md-12 offset-md-1 pt-4">
      
      <ul class="list-group list-group-horizontal" style="flex-direction: row">
        
        <li class="list-group-item b-0 p-0">

          <a type="button" class="btn btn-dark" role="button" href="http://www.kevssite.com/add-a-git-remote-as-https-instead-of-ssh/"
            data-toggle="tooltip" data-placement="top" title="Add a GIT remote as https instead of ssh">&larr;
            Previous Post</a>
        </li>
        


        
        <li class="list-group-item ms-auto b-0 p-0">
          <a type="button" class="btn btn-dark" role="button" href="http://www.kevssite.com/connect-to-postgresql-using-an-ssh-tunnel/"
            data-toggle="tooltip" data-placement="top" title="Connect to PostgreSQL using an SSH tunnel">Next Post
            &rarr;</a>
        </li>
        
      </ul>
      
    </div>

    <div class="col-lg-8 offset-lg-2 col-md-10 offset-md-1 pt-4">
    </div>
  </div>
  
</div>

<div class="">
  
  
  

  
  

  

</div>

    


<footer>

  <div class="container">
    <div class="row">
      <div class="col-md-12">
        <ul
          class="list-inline list-group list-group-horizontal text-center footer-links d-flex justify-content-center flex-row">

          
          <li>
            <a href="https://github.com/YorkshireKev" title="GitHub" target="_blank">
              <span class="mx-2">
                <i class="bi bi-github"></i>
              </span>
            </a>
          </li>
          <li>
            <a href="https://twitter.com/YorkshireKev" title="Twitter" target="_blank">
              <span class="mx-2">
                <i class="bi bi-twitter"></i>
              </span>
            </a>
          </li>
          <li>
            <a href="https://linkedin.com/in/elliskevin" title="LinkedIn" target="_blank">
              <span class="mx-2">
                <i class="bi bi-linkedin"></i>
              </span>
            </a>
          </li>
          <li>
            <a href="https://www.youtube.com/@kevschannel" title="Youtube" target="_blank">
              <span class="mx-2">
                <i class="bi bi-youtube"></i>
              </span>
            </a>
          </li>
          
        </ul>
      </div>
    </div>

    <div class="row">
      <div class="col-md-12">
        <p class="credits copyright text-muted">
          
          &nbsp;&copy;
          
          2009 - 2024
          
          Kevin Ellis
        </p>
      </div>
    </div>
  </div>
</footer><script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" crossorigin="anonymous"></script>
<script src="http://www.kevssite.com/js/highlight.min.js"></script>
<script> hljs.initHighlightingOnLoad(); </script>
<script> $(document).ready(function () { $("pre.chroma").css("padding", "0"); }); </script>
    
  </body>
</html>

